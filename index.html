<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fresheur.be - Recettes et Courses Intelligentes</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .fresh-gradient {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .recipe-card {
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .recipe-card.selected {
            border-color: #38ef7d;
            background-color: #f0fdf4;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Sample recipes database
        const RECIPES_DATABASE = [
            {
                id: 1,
                name: "Spaghetti Bolognaise",
                category: "P√¢tes",
                time: 30,
                difficulty: "Facile",
                price: 3.50,
                servings: 4,
                dietary: ["omnivore"],
                excludedIngredients: [],
                ingredients: [
                    { name: "Spaghetti", amount: "500g", price: 0.89, category: "√âpicerie", common: false },
                    { name: "Viande hach√©e", amount: "400g", price: 4.50, category: "Boucherie", common: false },
                    { name: "Tomates concass√©es", amount: "400g", price: 0.95, category: "√âpicerie", common: false },
                    { name: "Oignon", amount: "1", price: 0.25, category: "Fruits & L√©gumes", common: true },
                    { name: "Ail", amount: "2 gousses", price: 0.15, category: "Fruits & L√©gumes", common: true },
                    { name: "Huile d'olive", amount: "2 c.√†.s", price: 0.20, category: "√âpicerie", common: true },
                    { name: "Sel et poivre", amount: "Au go√ªt", price: 0.05, category: "√âpicerie", common: true }
                ],
                image: "üçù"
            },
            {
                id: 2,
                name: "Salade C√©sar au Poulet",
                category: "Salade",
                time: 20,
                difficulty: "Facile",
                price: 4.20,
                servings: 2,
                dietary: ["omnivore"],
                excludedIngredients: [],
                ingredients: [
                    { name: "Laitue romaine", amount: "1", price: 1.20, category: "Fruits & L√©gumes", common: false },
                    { name: "Poulet", amount: "200g", price: 2.80, category: "Boucherie", common: false },
                    { name: "Parmesan", amount: "50g", price: 1.50, category: "Cr√©merie", common: false },
                    { name: "Cro√ªtons", amount: "100g", price: 0.95, category: "√âpicerie", common: false },
                    { name: "Sauce C√©sar", amount: "100ml", price: 1.20, category: "√âpicerie", common: false },
                    { name: "Huile d'olive", amount: "1 c.√†.s", price: 0.10, category: "√âpicerie", common: true }
                ],
                image: "ü•ó"
            },
            {
                id: 3,
                name: "Curry de L√©gumes Vegan",
                category: "V√©g√©tarien",
                time: 35,
                difficulty: "Moyen",
                price: 3.80,
                servings: 4,
                dietary: ["vegetarien", "vegan"],
                excludedIngredients: ["viande", "poisson", "produits laitiers", "oeufs"],
                ingredients: [
                    { name: "Pois chiches", amount: "400g", price: 0.85, category: "√âpicerie", common: false },
                    { name: "Lait de coco", amount: "400ml", price: 1.45, category: "√âpicerie", common: false },
                    { name: "Curry en poudre", amount: "2 c.√†.s", price: 0.30, category: "√âpicerie", common: true },
                    { name: "Carottes", amount: "2", price: 0.40, category: "Fruits & L√©gumes", common: false },
                    { name: "Courgette", amount: "1", price: 0.80, category: "Fruits & L√©gumes", common: false },
                    { name: "Oignon", amount: "1", price: 0.25, category: "Fruits & L√©gumes", common: true },
                    { name: "Riz", amount: "300g", price: 0.60, category: "√âpicerie", common: false },
                    { name: "Ail", amount: "2 gousses", price: 0.15, category: "Fruits & L√©gumes", common: true }
                ],
                image: "üçõ"
            },
            {
                id: 4,
                name: "Omelette aux Champignons",
                category: "Oeufs",
                time: 15,
                difficulty: "Facile",
                price: 2.50,
                servings: 2,
                dietary: ["vegetarien"],
                excludedIngredients: ["viande", "poisson"],
                ingredients: [
                    { name: "Oeufs", amount: "4", price: 1.20, category: "Cr√©merie", common: false },
                    { name: "Champignons", amount: "200g", price: 1.50, category: "Fruits & L√©gumes", common: false },
                    { name: "Fromage r√¢p√©", amount: "50g", price: 0.80, category: "Cr√©merie", common: false },
                    { name: "Beurre", amount: "20g", price: 0.15, category: "Cr√©merie", common: true },
                    { name: "Sel et poivre", amount: "Au go√ªt", price: 0.05, category: "√âpicerie", common: true }
                ],
                image: "üç≥"
            },
            {
                id: 5,
                name: "Saumon Grill√© & L√©gumes",
                category: "Poisson",
                time: 25,
                difficulty: "Moyen",
                price: 7.50,
                servings: 2,
                dietary: ["omnivore", "pescetarien"],
                excludedIngredients: ["viande"],
                ingredients: [
                    { name: "Filet de saumon", amount: "300g", price: 6.50, category: "Poissonnerie", common: false },
                    { name: "Brocoli", amount: "200g", price: 1.20, category: "Fruits & L√©gumes", common: false },
                    { name: "Citron", amount: "1", price: 0.40, category: "Fruits & L√©gumes", common: false },
                    { name: "Huile d'olive", amount: "2 c.√†.s", price: 0.20, category: "√âpicerie", common: true },
                    { name: "Sel et poivre", amount: "Au go√ªt", price: 0.05, category: "√âpicerie", common: true },
                    { name: "Ail", amount: "1 gousse", price: 0.08, category: "Fruits & L√©gumes", common: true }
                ],
                image: "üêü"
            },
            {
                id: 6,
                name: "Pizza Margherita Maison",
                category: "Pizza",
                time: 45,
                difficulty: "Moyen",
                price: 3.20,
                servings: 4,
                dietary: ["vegetarien"],
                excludedIngredients: ["viande", "poisson"],
                ingredients: [
                    { name: "P√¢te √† pizza", amount: "1", price: 1.20, category: "Boulangerie", common: false },
                    { name: "Sauce tomate", amount: "200g", price: 0.75, category: "√âpicerie", common: false },
                    { name: "Mozzarella", amount: "200g", price: 2.20, category: "Cr√©merie", common: false },
                    { name: "Basilic frais", amount: "1 bouquet", price: 0.80, category: "Fruits & L√©gumes", common: false },
                    { name: "Huile d'olive", amount: "1 c.√†.s", price: 0.10, category: "√âpicerie", common: true },
                    { name: "Origan", amount: "1 c.√†.c", price: 0.05, category: "√âpicerie", common: true }
                ],
                image: "üçï"
            },
            {
                id: 7,
                name: "Soupe de Lentilles",
                category: "Soupe",
                time: 40,
                difficulty: "Facile",
                price: 2.80,
                servings: 4,
                dietary: ["vegetarien", "vegan"],
                excludedIngredients: ["viande", "poisson", "produits laitiers", "oeufs"],
                ingredients: [
                    { name: "Lentilles", amount: "300g", price: 0.95, category: "√âpicerie", common: false },
                    { name: "Carottes", amount: "2", price: 0.40, category: "Fruits & L√©gumes", common: false },
                    { name: "C√©leri", amount: "2 branches", price: 0.50, category: "Fruits & L√©gumes", common: false },
                    { name: "Oignon", amount: "1", price: 0.25, category: "Fruits & L√©gumes", common: true },
                    { name: "Bouillon de l√©gumes", amount: "1L", price: 0.60, category: "√âpicerie", common: false },
                    { name: "Cumin", amount: "1 c.√†.c", price: 0.10, category: "√âpicerie", common: true }
                ],
                image: "üç≤"
            },
            {
                id: 8,
                name: "Tacos au Boeuf",
                category: "Mexicain",
                time: 25,
                difficulty: "Facile",
                price: 5.20,
                servings: 4,
                dietary: ["omnivore"],
                excludedIngredients: [],
                ingredients: [
                    { name: "Tortillas", amount: "8", price: 1.80, category: "√âpicerie", common: false },
                    { name: "Boeuf hach√©", amount: "400g", price: 4.80, category: "Boucherie", common: false },
                    { name: "Salade", amount: "1", price: 0.90, category: "Fruits & L√©gumes", common: false },
                    { name: "Tomates", amount: "2", price: 0.60, category: "Fruits & L√©gumes", common: false },
                    { name: "Fromage r√¢p√©", amount: "100g", price: 1.20, category: "Cr√©merie", common: false },
                    { name: "√âpices mexicaines", amount: "2 c.√†.s", price: 0.30, category: "√âpicerie", common: true }
                ],
                image: "üåÆ"
            }
        ];

        const DIETARY_OPTIONS = [
            { id: "omnivore", name: "Omnivore", description: "Je mange de tout" },
            { id: "vegetarien", name: "V√©g√©tarien", description: "Pas de viande ni poisson" },
            { id: "vegan", name: "Vegan", description: "Aucun produit animal" },
            { id: "pescetarien", name: "Pesc√©tarien", description: "Poisson mais pas de viande" }
        ];

        const COMMON_ALLERGENS = [
            "gluten", "produits laitiers", "oeufs", "poisson", "crustac√©s",
            "arachides", "fruits √† coque", "soja", "c√©leri", "moutarde"
        ];

        const STORES = ["Delhaize", "Colruyt", "Carrefour", "Aldi", "Lidl"];

        function FresheurApp() {
            const [currentStep, setCurrentStep] = useState('welcome');
            const [userProfile, setUserProfile] = useState({
                name: '',
                household: 2,
                dietary: 'omnivore',
                excludedIngredients: [],
                weeklyBudget: 50,
                preferredStore: 'Delhaize'
            });
            const [selectedRecipes, setSelectedRecipes] = useState([]);
            const [shoppingList, setShoppingList] = useState([]);
            const [commonIngredients, setCommonIngredients] = useState([]);

            useEffect(() => {
                const saved = localStorage.getItem('fresheur_profile');
                if (saved) {
                    const profile = JSON.parse(saved);
                    setUserProfile(profile);
                    if (profile.name) {
                        setCurrentStep('recipes');
                    }
                }
            }, []);

            const saveProfile = (profile) => {
                localStorage.setItem('fresheur_profile', JSON.stringify(profile));
                setUserProfile(profile);
            };

            const filteredRecipes = RECIPES_DATABASE.filter(recipe => {
                const matchesDietary = recipe.dietary.includes(userProfile.dietary);
                const hasExcluded = recipe.excludedIngredients.some(ing => 
                    userProfile.excludedIngredients.includes(ing)
                );
                return matchesDietary && !hasExcluded;
            });

            const toggleRecipe = (recipe) => {
                if (selectedRecipes.find(r => r.id === recipe.id)) {
                    setSelectedRecipes(selectedRecipes.filter(r => r.id !== recipe.id));
                } else {
                    setSelectedRecipes([...selectedRecipes, recipe]);
                }
            };

            const generateShoppingList = () => {
                const ingredientsMap = new Map();
                const commonItems = [];

                selectedRecipes.forEach(recipe => {
                    recipe.ingredients.forEach(ingredient => {
                        if (ingredient.common) {
                            if (!commonItems.find(i => i.name === ingredient.name)) {
                                commonItems.push(ingredient);
                            }
                        } else {
                            if (ingredientsMap.has(ingredient.name)) {
                                const existing = ingredientsMap.get(ingredient.name);
                                existing.recipes.push(recipe.name);
                            } else {
                                ingredientsMap.set(ingredient.name, {
                                    ...ingredient,
                                    recipes: [recipe.name],
                                    checked: false
                                });
                            }
                        }
                    });
                });

                setShoppingList(Array.from(ingredientsMap.values()));
                setCommonIngredients(commonItems);
                setCurrentStep('shopping');
            };

            const totalCost = shoppingList.reduce((sum, item) => sum + item.price, 0);
            const totalRecipeCost = selectedRecipes.reduce((sum, recipe) => sum + recipe.price, 0);

            if (currentStep === 'welcome') {
                return <WelcomeScreen onStart={() => setCurrentStep('profile')} />;
            }

            if (currentStep === 'profile') {
                return <ProfileSetup 
                    userProfile={userProfile}
                    onSave={(profile) => {
                        saveProfile(profile);
                        setCurrentStep('recipes');
                    }}
                />;
            }

            if (currentStep === 'recipes') {
                return (
                    <div className="min-h-screen bg-gray-50">
                        <Header userProfile={userProfile} onProfile={() => setCurrentStep('profile')} />
                        <RecipeSelection 
                            recipes={filteredRecipes}
                            selectedRecipes={selectedRecipes}
                            onToggle={toggleRecipe}
                            userProfile={userProfile}
                        />
                        {selectedRecipes.length > 0 && (
                            <div className="fixed bottom-0 left-0 right-0 bg-white shadow-lg p-4 border-t">
                                <div className="max-w-7xl mx-auto flex items-center justify-between">
                                    <div>
                                        <p className="text-lg font-semibold">{selectedRecipes.length} recette(s) s√©lectionn√©e(s)</p>
                                        <p className="text-sm text-gray-600">Budget estim√©: ~{totalRecipeCost.toFixed(2)}‚Ç¨</p>
                                    </div>
                                    <button
                                        onClick={generateShoppingList}
                                        className="fresh-gradient text-white px-8 py-3 rounded-full font-semibold hover:opacity-90 transition"
                                    >
                                        Cr√©er ma liste de courses ‚Üí
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            if (currentStep === 'shopping') {
                return (
                    <ShoppingList 
                        shoppingList={shoppingList}
                        commonIngredients={commonIngredients}
                        totalCost={totalCost}
                        userProfile={userProfile}
                        onBack={() => setCurrentStep('recipes')}
                        onUpdate={setShoppingList}
                        onUpdateCommon={setCommonIngredients}
                    />
                );
            }
        }

        function WelcomeScreen({ onStart }) {
            return (
                <div className="min-h-screen fresh-gradient flex items-center justify-center p-4">
                    {/* Construction Banner */}
                    <div className="fixed top-0 left-0 right-0 bg-yellow-400 text-gray-900 py-3 px-4 text-center font-semibold z-50 shadow-lg">
                        <div className="max-w-4xl mx-auto flex items-center justify-center gap-2">
                            <span className="text-2xl">üöß</span>
                            <span>Site en construction ‚Ä¢ Testez notre prototype et donnez-nous votre avis !</span>
                            <span className="text-2xl">üöß</span>
                        </div>
                    </div>
                    <div className="text-center animate-fade-in mt-16">
                        <div className="mb-6 flex justify-center">
                            <img src="Logo1.PNG" alt="Fresheur Logo" className="w-64 h-64 object-contain drop-shadow-2xl" />
                        </div>
                        <h1 className="text-5xl font-bold text-white mb-4">Fresheur</h1>
                        <p className="text-xl text-white opacity-90 mb-8 max-w-md mx-auto">
                            Recettes personnalis√©es liste de courses adapt√©e et budget ma√Ætris√© ! 
                        </p>
                        <button
                            onClick={onStart}
                            className="bg-white text-green-600 px-8 py-4 rounded-full font-semibold text-lg hover:bg-gray-50 transition shadow-lg"
                        >
                            Commencer ‚Üí
                        </button>
                        <p className="text-white opacity-75 mt-6 text-sm">
                             Pens√© pour faire face aux tracas du quotidien
                        </p>
                    </div>
                </div>
            );
        }

        function ProfileSetup({ userProfile, onSave }) {
            const [profile, setProfile] = useState(userProfile);

            const toggleExcluded = (ingredient) => {
                if (profile.excludedIngredients.includes(ingredient)) {
                    setProfile({
                        ...profile,
                        excludedIngredients: profile.excludedIngredients.filter(i => i !== ingredient)
                    });
                } else {
                    setProfile({
                        ...profile,
                        excludedIngredients: [...profile.excludedIngredients, ingredient]
                    });
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(profile);
            };

            return (
                <div className="min-h-screen bg-gray-50 py-8 px-4">
                    <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-8 animate-fade-in">
                        <div className="text-center mb-8">
                            <h2 className="text-3xl font-bold text-gray-800 mb-2">Cr√©ez votre profil</h2>
                            <p className="text-gray-600">Pour des recettes sur-mesure</p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    Votre pr√©nom
                                </label>
                                <input
                                    type="text"
                                    value={profile.name}
                                    onChange={(e) => setProfile({...profile, name: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                    placeholder="Ex: Marie"
                                    required
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    Nombre de personnes dans votre foyer
                                </label>
                                <select
                                    value={profile.household}
                                    onChange={(e) => setProfile({...profile, household: parseInt(e.target.value)})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                >
                                    {[1,2,3,4,5,6].map(n => (
                                        <option key={n} value={n}>{n} personne{n>1?'s':''}</option>
                                    ))}
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-3">
                                    R√©gime alimentaire
                                </label>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    {DIETARY_OPTIONS.map(option => (
                                        <label 
                                            key={option.id}
                                            className={`border-2 rounded-lg p-4 cursor-pointer transition ${
                                                profile.dietary === option.id 
                                                    ? 'border-green-500 bg-green-50' 
                                                    : 'border-gray-200 hover:border-gray-300'
                                            }`}
                                        >
                                            <input
                                                type="radio"
                                                name="dietary"
                                                value={option.id}
                                                checked={profile.dietary === option.id}
                                                onChange={(e) => setProfile({...profile, dietary: e.target.value})}
                                                className="hidden"
                                            />
                                            <div className="font-semibold text-gray-800">{option.name}</div>
                                            <div className="text-sm text-gray-600">{option.description}</div>
                                        </label>
                                    ))}
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-3">
                                    Ingr√©dients √† exclure (allergies, intol√©rances)
                                </label>
                                <div className="flex flex-wrap gap-2">
                                    {COMMON_ALLERGENS.map(allergen => (
                                        <button
                                            key={allergen}
                                            type="button"
                                            onClick={() => toggleExcluded(allergen)}
                                            className={`px-4 py-2 rounded-full text-sm font-medium transition ${
                                                profile.excludedIngredients.includes(allergen)
                                                    ? 'bg-red-500 text-white'
                                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                            }`}
                                        >
                                            {allergen}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    Budget courses hebdomadaire: {profile.weeklyBudget}‚Ç¨
                                </label>
                                <input
                                    type="range"
                                    min="20"
                                    max="200"
                                    step="10"
                                    value={profile.weeklyBudget}
                                    onChange={(e) => setProfile({...profile, weeklyBudget: parseInt(e.target.value)})}
                                    className="w-full"
                                />
                                <div className="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>20‚Ç¨</span>
                                    <span>200‚Ç¨</span>
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    Magasin pr√©f√©r√©
                                </label>
                                <select
                                    value={profile.preferredStore}
                                    onChange={(e) => setProfile({...profile, preferredStore: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                >
                                    {STORES.map(store => (
                                        <option key={store} value={store}>{store}</option>
                                    ))}
                                </select>
                            </div>

                            <button
                                type="submit"
                                className="w-full fresh-gradient text-white py-4 rounded-lg font-semibold text-lg hover:opacity-90 transition shadow-lg"
                            >
                                Sauvegarder mon profil
                            </button>
                        </form>
                    </div>
                </div>
            );
        }

        function Header({ userProfile, onProfile }) {
            return (
                <>
                    {/* Construction Banner */}
                    <div className="bg-yellow-400 text-gray-900 py-2 px-4 text-center text-sm font-semibold">
                        üöß Version Beta ‚Ä¢ Site en construction üöß
                    </div>
                    <header className="bg-white shadow-sm sticky top-0 z-50">
                    <div className="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                        <div className="flex items-center space-x-3">
                            <img src="Logo1.PNG" alt="Fresheur" className="w-10 h-10 object-contain" />
                            <h1 className="text-2xl font-bold text-gray-800">Fresheur.be</h1>
                        </div>
                        <div className="flex items-center space-x-4">
                            <div className="text-right hidden md:block">
                                <p className="text-sm text-gray-600">Bonjour, {userProfile.name}!</p>
                                <p className="text-xs text-gray-500">Budget: {userProfile.weeklyBudget}‚Ç¨/sem</p>
                            </div>
                            <button
                                onClick={onProfile}
                                className="px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition text-sm font-medium"
                            >
                                ‚öôÔ∏è Profil
                            </button>
                        </div>
                    </div>
                </header>
                </>
            );
        }

        function RecipeSelection({ recipes, selectedRecipes, onToggle, userProfile }) {
            const [filter, setFilter] = useState('all');

            const categories = ['all', ...new Set(recipes.map(r => r.category))];
            
            const filteredByCategory = filter === 'all' 
                ? recipes 
                : recipes.filter(r => r.category === filter);

            return (
                <div className="max-w-7xl mx-auto px-4 py-8 pb-32">
                    <div className="mb-8">
                        <h2 className="text-3xl font-bold text-gray-800 mb-2">Choisissez vos recettes</h2>
                        <p className="text-gray-600">S√©lectionnez les plats qui vous font envie cette semaine</p>
                    </div>

                    <div className="flex flex-wrap gap-2 mb-8">
                        {categories.map(cat => (
                            <button
                                key={cat}
                                onClick={() => setFilter(cat)}
                                className={`px-4 py-2 rounded-full text-sm font-medium transition ${
                                    filter === cat
                                        ? 'fresh-gradient text-white'
                                        : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                }`}
                            >
                                {cat === 'all' ? 'Toutes' : cat}
                            </button>
                        ))}
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {filteredByCategory.map(recipe => {
                            const isSelected = selectedRecipes.find(r => r.id === recipe.id);
                            return (
                                <div
                                    key={recipe.id}
                                    onClick={() => onToggle(recipe)}
                                    className={`recipe-card bg-white rounded-xl shadow-md p-6 card-hover ${isSelected ? 'selected' : ''}`}
                                >
                                    <div className="text-5xl mb-3">{recipe.image}</div>
                                    <h3 className="text-xl font-bold text-gray-800 mb-2">{recipe.name}</h3>
                                    <div className="flex flex-wrap gap-2 mb-3">
                                        <span className="badge bg-blue-100 text-blue-800">‚è±Ô∏è {recipe.time} min</span>
                                        <span className="badge bg-purple-100 text-purple-800">üë®‚Äçüç≥ {recipe.difficulty}</span>
                                        <span className="badge bg-green-100 text-green-800">üí∞ {recipe.price.toFixed(2)}‚Ç¨</span>
                                    </div>
                                    <p className="text-sm text-gray-600 mb-2">
                                        {recipe.servings} personnes ‚Ä¢ {recipe.ingredients.length} ingr√©dients
                                    </p>
                                    {isSelected && (
                                        <div className="mt-3 text-green-600 font-semibold flex items-center">
                                            ‚úì Ajout√©e √† votre menu
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>

                    {filteredByCategory.length === 0 && (
                        <div className="text-center py-12">
                            <p className="text-gray-500 text-lg">Aucune recette ne correspond √† vos crit√®res</p>
                            <p className="text-gray-400 text-sm mt-2">Essayez de modifier vos filtres ou votre profil</p>
                        </div>
                    )}
                </div>
            );
        }

        function ShoppingList({ shoppingList, commonIngredients, totalCost, userProfile, onBack, onUpdate, onUpdateCommon }) {
            const toggleItem = (itemName) => {
                onUpdate(shoppingList.map(item => 
                    item.name === itemName ? {...item, checked: !item.checked} : item
                ));
            };

            const toggleCommonItem = (itemName) => {
                onUpdateCommon(commonIngredients.map(item => 
                    item.name === itemName ? {...item, checked: !item.checked} : item
                ));
            };

            const removeCommonItem = (itemName) => {
                onUpdateCommon(commonIngredients.filter(item => item.name !== itemName));
            };

            const groupedByCategory = shoppingList.reduce((acc, item) => {
                if (!acc[item.category]) acc[item.category] = [];
                acc[item.category].push(item);
                return acc;
            }, {});

            const checkedCommonTotal = commonIngredients
                .filter(item => item.checked)
                .reduce((sum, item) => sum + item.price, 0);

            const finalTotal = totalCost + checkedCommonTotal;

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-white shadow-sm sticky top-0 z-50">
                        <div className="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
                            <button
                                onClick={onBack}
                                className="px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition text-sm font-medium"
                            >
                                ‚Üê Retour aux recettes
                            </button>
                            <div className="text-right">
                                <p className="font-bold text-lg text-gray-800">{finalTotal.toFixed(2)}‚Ç¨</p>
                                <p className="text-xs text-gray-500">Total estim√©</p>
                            </div>
                        </div>
                    </header>

                    <div className="max-w-4xl mx-auto px-4 py-8">
                        <div className="mb-8">
                            <h2 className="text-3xl font-bold text-gray-800 mb-2">Votre liste de courses</h2>
                            <p className="text-gray-600">Bas√©e sur vos recettes ‚Ä¢ {userProfile.preferredStore}</p>
                        </div>

                        {commonIngredients.length > 0 && (
                            <div className="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 mb-6">
                                <h3 className="font-bold text-lg text-gray-800 mb-3">
                                    üí° Vous avez peut-√™tre d√©j√† ces ingr√©dients
                                </h3>
                                <p className="text-sm text-gray-600 mb-4">
                                    Cochez ceux que vous poss√©dez d√©j√† pour les ajouter au co√ªt total
                                </p>
                                <div className="space-y-2">
                                    {commonIngredients.map(item => (
                                        <div key={item.name} className="flex items-center justify-between bg-white rounded-lg p-3">
                                            <label className="flex items-center space-x-3 cursor-pointer flex-1">
                                                <input
                                                    type="checkbox"
                                                    checked={item.checked || false}
                                                    onChange={() => toggleCommonItem(item.name)}
                                                    className="w-5 h-5 text-yellow-600 rounded focus:ring-yellow-500"
                                                />
                                                <div className="flex-1">
                                                    <span className="text-gray-800 font-medium">{item.name}</span>
                                                    <span className="text-gray-500 text-sm ml-2">({item.amount})</span>
                                                </div>
                                            </label>
                                            <div className="flex items-center space-x-3">
                                                <span className="text-gray-600 font-semibold">{item.price.toFixed(2)}‚Ç¨</span>
                                                <button
                                                    onClick={() => removeCommonItem(item.name)}
                                                    className="text-red-500 hover:text-red-700 text-sm"
                                                >
                                                    ‚úï
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                {checkedCommonTotal > 0 && (
                                    <p className="text-sm text-yellow-700 mt-3 font-semibold">
                                        +{checkedCommonTotal.toFixed(2)}‚Ç¨ ajout√©s au total
                                    </p>
                                )}
                            </div>
                        )}

                        {Object.entries(groupedByCategory).map(([category, items]) => (
                            <div key={category} className="bg-white rounded-xl shadow-md p-6 mb-4">
                                <h3 className="font-bold text-lg text-gray-800 mb-4 border-b pb-2">
                                    {category}
                                </h3>
                                <div className="space-y-3">
                                    {items.map(item => (
                                        <div 
                                            key={item.name}
                                            className={`flex items-center justify-between p-3 rounded-lg transition ${
                                                item.checked ? 'bg-gray-50 opacity-60' : 'hover:bg-gray-50'
                                            }`}
                                        >
                                            <label className="flex items-center space-x-3 cursor-pointer flex-1">
                                                <input
                                                    type="checkbox"
                                                    checked={item.checked}
                                                    onChange={() => toggleItem(item.name)}
                                                    className="w-5 h-5 text-green-600 rounded focus:ring-green-500"
                                                />
                                                <div className="flex-1">
                                                    <div className={`font-medium ${item.checked ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                                                        {item.name}
                                                    </div>
                                                    <div className="text-sm text-gray-500">
                                                        {item.amount} ‚Ä¢ Pour: {item.recipes.join(', ')}
                                                    </div>
                                                </div>
                                            </label>
                                            <span className={`font-semibold ${item.checked ? 'text-gray-400' : 'text-gray-700'}`}>
                                                {item.price.toFixed(2)}‚Ç¨
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}

                        <div className="bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-xl p-6 shadow-lg">
                            <div className="flex justify-between items-center mb-4">
                                <div>
                                    <p className="text-sm opacity-90">Total estim√©</p>
                                    <p className="text-3xl font-bold">{finalTotal.toFixed(2)}‚Ç¨</p>
                                </div>
                                <div className="text-right">
                                    <p className="text-sm opacity-90">Budget restant</p>
                                    <p className="text-2xl font-bold">
                                        {(userProfile.weeklyBudget - finalTotal).toFixed(2)}‚Ç¨
                                    </p>
                                </div>
                            </div>
                            <button className="w-full bg-white text-green-600 py-3 rounded-lg font-semibold hover:bg-gray-50 transition">
                                üöö Commander chez {userProfile.preferredStore}
                            </button>
                            <p className="text-center text-xs opacity-75 mt-3">
                                Fonctionnalit√© de livraison P2P bient√¥t disponible
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<FresheurApp />, document.getElementById('root'));
    </script>
</body>
</html>